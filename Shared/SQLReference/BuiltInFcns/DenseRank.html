<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="reference" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-conditions="Review.ReviewOff" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="SQL Reference|SQL Built-in Functions|Window and Aggregate Functions">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="Built-in SQL window function that returns the rank of a value within a partition of values defined by its OVER clause" /><title>DENSE RANK built-in SQL window function</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/SpliceTriPaneStyles.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#Shared/SQLReference/BuiltInFcns/DenseRank.html">Open topic with navigation</a>
        </p>
        <div class="TopicContent">
            <h1><a name="kanchor334"></a>DENSE_RANK()</h1>
            <p><span class="CodeFont">DENSE_RANK()</span> is a <span class="ItalicFont">ranking function</span> that returns the rank of a value within the ordered partition of values defined by its <span class="CodeFont">OVER</span>&#160;clause. Ranking functions are a subset of <a href="Intro.WindowAggregrateFcns.html">window functions</a>.</p>
            <p class="heading2">Syntax</p>
            <div class="preWrapper"><pre class="FcnSyntax" xml:space="preserve">DENSE_RANK() OVER ( <span class="ItalicFont">overClause</span> )</pre>
            </div>
            <div class="paramList">
                <p class="paramName">overClause</p>
                <p class="paramDefnFirst">See the <span class="CodeFont"><a href="../Clauses/Over.html">OVER</a></span>&#160;clause documentation.</p>
                <p class="noteNote" data-mc-autonum="NOTE: &#160;"><span class="autonumber"><span class="noteAutoNum">NOTE: &#160;</span></span>Ranking functions such as <span class="CodeFont">DENSE_RANK</span>&#160;must include an <span class="CodeFont"><a href="../Clauses/OrderBy.html">ORDER&#160;BY</a></span>&#160;clause in the <span class="CodeFont">OVER</span>&#160;clause. This is because the ranking is calculated based on the ordering.</p>
            </div>
            <p class="heading2">Results</p>
            <p>The resulting data type is <span class="CodeFont"><a href="../DataTypes/BigInt.html">BIGINT</a></span>.</p>
            <p class="heading2">Usage</p>
            <p>The <span class="CodeFont">DENSE_RANK()</span> and <span class="CodeFont"><a href="Rank.html">RANK()</a></span> analytic functions are very similar. The difference shows up when there are multiple input rows that have the same ranking value. When that happens:</p>
            <ul>
                <li value="1">The <span class="CodeFont">DENSE_RANK()</span>&#160;function always returns consecutive rankings:if values in the ranking column are the same, they receive the same rank, and the next number in the ranking sequence is then used to rank the row or rows that follow.</li>
                <li value="2">The <span class="CodeFont">RANK()</span>&#160;function can generate non-consecutive ranking result values: if values in the ranking column are the same (tie values), they receive the same rank; however, the next number in the ranking sequence is then skipped, which means that <span class="CodeFont">RANK</span>&#160;can return non-consecutive numbers.</li>
            </ul>
            <p>Here's a simple example that shows the ranking produced by the two functions for input with duplicate values to illustrate that difference:</p>
            <div class="preWrapper"><pre class="Example" xml:space="preserve">-----------------------------
| Value | RANK | DENSE_RANK |
-----------------------------
| a     |    1 |          1 |
| a     |    1 |          1 |
| a     |    1 |          1 |
| b     |    4 |          2 |
| c     |    5 |          3 |
| c     |    5 |          3 |
| d     |    7 |          4 |
| e     |    8 |          5 |
-----------------------------</pre>
            </div>
            <p class="heading2">Example</p>
            <p class="body">The following query ranks the salaries of players, per team, whose salary is at least $1 million.</p>
            <div class="preWrapper"><pre class="Example" xml:space="preserve">SELECT DisplayName, Team, Season, Salary,
   DENSE_RANK() OVER (PARTITION BY Team ORDER BY Salary Desc) "RANK"
   FROM Players JOIN Salaries  ON Salaries.ID=Players.ID 
   WHERE Salary&gt;999999 AND Season=2015;

DISPLAYNAME             |TEAM     |SEASON|SALARY              |RANK 
---------------------------------------------------------------------
Mitch Hassleman         |Cards     |2015  |17000000            |1 
Yuri Milleton           |Cards     |2015  |15200000            |2 
James Grasser           |Cards     |2015  |9375000             |3 
Jack Hellman            |Cards     |2015  |8300000             |4 
Larry Lintos            |Cards     |2015  |7000000             |5 
Jeremy Johnson          |Cards     |2015  |4125000             |6 
Mitch Canepa            |Cards     |2015  |3750000             |7 
Mitch Brandon           |Cards     |2015  |3500000             |8 
Robert Cohen            |Cards     |2015  |3000000             |9 
James Woegren           |Cards     |2015  |2675000             |10
Sam Culligan            |Cards     |2015  |2652732             |11
Barry Morse             |Cards     |2015  |2379781             |12
Michael Rastono         |Cards     |2015  |2000000             |13
Carl Vanamos            |Cards     |2015  |2000000             |13
Alex Wister             |Cards     |2015  |1950000             |14
Pablo Bonjourno         |Cards     |2015  |1650000             |15
Jonathan Pearlman       |Cards     |2015  |1500000             |16
Jan Bromley             |Cards     |2015  |1200000             |17
Martin Cassman          |Giants    |2015  |20833333            |1 
Harry Pennello          |Giants    |2015  |18500000            |2 
Tam Lassiter            |Giants    |2015  |18000000            |3 
Buddy Painter           |Giants    |2015  |17277777            |4 
Thomas Hillman          |Giants    |2015  |12000000            |5 
Alex Paramour           |Giants    |2015  |10250000            |6 
Jack Peepers            |Giants    |2015  |9000000             |7 
Mark Briste             |Giants    |2015  |8000000             |8 
Marcus Bamburger        |Giants    |2015  |6950000             |9 
Jalen Ardson            |Giants    |2015  |6000000             |10
Steve Raster            |Giants    |2015  |6000000             |10
Sam Castleman           |Giants    |2015  |5000000             |11
Craig McGawn            |Giants    |2015  |4800000             |12
Norman Aikman           |Giants    |2015  |4000000             |13
Randy Varner            |Giants    |2015  |4000000             |13
Jason Lilliput          |Giants    |2015  |4000000             |13
Billy Bopper            |Giants    |2015  |3600000             |14
Greg Brown              |Giants    |2015  |3600000             |14
Mitch Lovell            |Giants    |2015  |3578825             |15
Bob Cranker             |Giants    |2015  |3175000             |16
Yuri Piamam             |Giants    |2015  |2100000             |17
Joseph Arkman           |Giants    |2015  |1450000             |18
Trevor Imhof            |Giants    |2015  |1100000             |19
Jason Minman            |Giants    |2015  |1000000             |20

42 rows selected
</pre>
            </div>
            <p>Here's the same query using <span class="CodeFont">RANK</span>&#160;instead of <span class="CodeFont">DENSE_RANK</span>. Note how tied rankings are handled differently:</p>
            <div class="preWrapper"><pre class="Example" xml:space="preserve">SELECT DisplayName, Team, Season, Salary,
   RANK() OVER (PARTITION BY Team ORDER BY Salary Desc) "RANK"
   FROM Players JOIN Salaries  ON Salaries.ID=Players.ID 
   WHERE Salary&gt;999999 AND Season=2015;

DISPLAYNAME             |TEAM     |SEASON|SALARY              |RANK 
---------------------------------------------------------------------
Mitch Hassleman         |Cards     |2015  |17000000            |1 
Yuri Milleton           |Cards     |2015  |15200000            |2 
James Grasser           |Cards     |2015  |9375000             |3 
Jack Hellman            |Cards     |2015  |8300000             |4 
Larry Lintos            |Cards     |2015  |7000000             |5 
Jeremy Johnson          |Cards     |2015  |4125000             |6 
Mitch Canepa            |Cards     |2015  |3750000             |7 
Mitch Brandon           |Cards     |2015  |3500000             |8 
Robert Cohen            |Cards     |2015  |3000000             |9 
James Woegren           |Cards     |2015  |2675000             |10
Sam Culligan            |Cards     |2015  |2652732             |11
Barry Morse             |Cards     |2015  |2379781             |12
Michael Rastono         |Cards     |2015  |2000000             |13
Carl Vanamos            |Cards     |2015  |2000000             |13
Alex Wister             |Cards     |2015  |1950000             |15
Pablo Bonjourno         |Cards     |2015  |1650000             |16
Jonathan Pearlman       |Cards     |2015  |1500000             |17
Jan Bromley             |Cards     |2015  |1200000             |18
Martin Cassman          |Giants    |2015  |20833333            |1 
Harry Pennello          |Giants    |2015  |18500000            |2 
Tam Lassiter            |Giants    |2015  |18000000            |3 
Buddy Painter           |Giants    |2015  |17277777            |4 
Thomas Hillman          |Giants    |2015  |12000000            |5 
Alex Paramour           |Giants    |2015  |10250000            |6 
Jack Peepers            |Giants    |2015  |9000000             |7 
Mark Briste             |Giants    |2015  |8000000             |8 
Marcus Bamburger        |Giants    |2015  |6950000             |9 
Jalen Ardson            |Giants    |2015  |6000000             |10
Steve Raster            |Giants    |2015  |6000000             |10
Sam Castleman           |Giants    |2015  |5000000             |12
Craig McGawn            |Giants    |2015  |4800000             |13
Norman Aikman           |Giants    |2015  |4000000             |14
Randy Varner            |Giants    |2015  |4000000             |14
Jason Lilliput          |Giants    |2015  |4000000             |14
Billy Bopper            |Giants    |2015  |3600000             |17
Greg Brown              |Giants    |2015  |3600000             |17
Mitch Lovell            |Giants    |2015  |3578825             |19
Bob Cranker             |Giants    |2015  |3175000             |20
Yuri Piamam             |Giants    |2015  |2100000             |21
Joseph Arkman           |Giants    |2015  |1450000             |22
Trevor Imhof            |Giants    |2015  |1100000             |23
Jason Minman            |Giants    |2015  |1000000             |24

42 rows selected
</pre>
            </div>
            <p class="heading2">See Also</p>
            <ul>
                <li value="1"><a href="Intro.WindowAggregrateFcns.html">Window and Aggregate </a>functions</li>
                <li value="2"><a href="../DataTypes/BigInt.html"><span class="CodeFont">BIGINT</span></a>&#160;data type</li>
                <li value="3"><a href="Rank.html"><span class="CodeFont">RANK</span></a>&#160;function</li>
                <li value="4"><a href="../Clauses/Over.html"><span class="CodeFont">OVER</span></a>&#160;clause</li>
                <li value="5"><span class="ItalicFont"><a href="../../Developers/Fundamentals/UsingWindowFunctions.html">Using Window Functions</a></span> in the <span class="ItalicFont">Developer Guide</span>.</li>
            </ul>
            <p style="font-size: 6pt;margin-top: 0;margin-bottom: 0;">&#160;</p>
        </div>
    </body>
</html>