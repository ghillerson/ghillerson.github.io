[Open topic with navigation](../../../index.html#Shared/SQLReference/Statements/AlterTable.html)

<a href="" id="Statements.AlterTable"></a>[]()ALTER TABLE
=========================================================

The <span class="CodeFont">ALTER TABLE</span> statement allows you to modify a table in a variety of ways, including adding and dropping columns and constraints from the table.

Syntax

``` FcnSyntax
ALTER TABLE table-Name
   {
   ADD COLUMN column-definition |
   ADD CONSTRAINT clause |
   DROP [ COLUMN ] column-name
   DROP { UNIQUE constraint-name |
          CHECK constraint-name
   }
   ALTER [ COLUMN ] column-alteration
   }
```

<a href="" id="ColumnDefinition"></a>column-definition

``` FcnSyntax
Simple-column-Name [ DataType ]
[ Column-level-constraint ]*
[ [ WITH ] DEFAULT DefaultConstantExpression 
 | generation-clause  
]
```

The syntax for the <span class="ItalicFont">column-definition</span> for a new column is a subset of the syntax for a column in a <span class="CodeFont">[CREATE TABLE](CreateTable.html)</span> statement.

The <span class="ItalicFont">DataType</span> can be omitted only if you specify a <span class="ItalicFont">generation-clause</span>. If you omit the <span class="ItalicFont">DataType</span>, the type of the generated column is the type of the <span class="ItalicFont">generation-clause</span>. If you specify both a <span class="ItalicFont">DataType</span> and a <span class="ItalicFont">generation-clause</span>, the type of the <span class="ItalicFont">generation-clause</span> must be assignable to <span class="ItalicFont">DataType</span>.

<a href="" id="ColumnAlteration"></a>column-alteration

``` FcnSyntax
column-Name SET DATA TYPE VARCHAR(integer) |
column-name SET INCREMENT BY integer-constant |
column-name RESTART WITH integer-constant |
column-name [ NOT ] NULL |
column-name [ WITH | SET ] DEFAULT default-value |
column-name DROP DEFAULT
```

In the column-alteration, <span class="CodeFont">SET INCREMENT BY</span> integer-constant specifies the interval between consecutive values of the identity column. The next value to be generated for the identity column will be determined from the last assigned value with the increment applied. The column must already be defined with the <span class="CodeFont">IDENTITY</span> attribute.

<span class="CodeFont">RESTART WITH</span> integer-constant specifies the next value to be generated for the identity column. <span class="CodeFont">RESTART WITH</span> is useful for a table that has an identity column that was defined as <span class="CodeFont">GENERATED BY DEFAULT</span>and that has a unique key defined on that identity column.

Because <span class="CodeFont">GENERATED BY DEFAULT</span> allows both manual inserts and system generated values, it is possible that manually inserted values can conflict with system generated values. To work around such conflicts, use the <span class="CodeFont">RESTART WITH</span> syntax to specify the next value that will be generated for the identity column.

Consider the following example, which involves a combination of automatically generated data and manually inserted data:

``` Example
CREATE TABLE tauto(i INT GENERATED BY DEFAULT AS IDENTITY,
                   k INT)
     CREATE UNIQUE INDEX tautoInd ON tauto(i)
     INSERT INTO tauto(k) values 1,2;
```

The system will automatically generate values for the identity column. But now you need to manually insert some data into the identity column:

``` Example
INSERT INTO tauto VALUES (3,3);
INSERT INTO tauto VALUES (4,4);
INSERT INTO tauto VALUES (5,5);
```

The identity column has used values 1 through 5 at this point. If you now want the system to generate a value, the system will generate a 3, which will result in a unique key exception because the value 3 has already been manually inserted. To compensate for the manual inserts, issue an <span class="CodeFont">ALTER TABLE</span> statement for the identity column with <span class="CodeFont">RESTART WITH 6</span>:

``` Example
ALTER TABLE tauto ALTER COLUMN i RESTART WITH 6;
```

<span class="CodeFont">ALTER TABLE</span> does not affect any view that references the table being altered. This includes views that have a wildcard asterisk (<span class="CodeFont">\*</span>) in their <span class="CodeFont">SELECT</span> list. You must drop and re-create those views if you wish them to return the new columns.

To change a column constraint to <span class="CodeFont">NOT NULL</span>, there has to be a valid value for the column.

Splice Machine raises an error if you try to change the <span class="ItalicFont">DataType</span> of a generated column to a type which is not assignable from the type of the <span class="ItalicFont">generation-clause</span>. Splice Machine also raises an error if you try to add a <span class="CodeFont">DEFAULT</span> clause to a generated column.

Usage

The <span class="CodeFont">ALTER TABLE</span> statement allows you to:

-   add a column to a table
-   add a constraint to a table
-   drop a column from a table
-   drop an existing constraint from a table<span class="important">\*</span>
-   increase the width of a <span class="CodeFont">VARCHAR</span> column
-   change the increment value and start value of the identity column
-   change the nullability constraint for a column
-   change the default value for a column

<span class="autonumber"><span class="noteAutoNum">RELEASE NOTE:  </span></span>You cannot currently use <span class="CodeFont">ALTER TABLE</span> to drop a foreign key constraint in Splice Machine. Until that capability is available, we recommend re-creating the table without the constraint.

Adding columns

The syntax for the <span class="ItalicFont">[column-definition](#ColumnDefinition)</span> for a new column is almost the same as for a column in a <span class="CodeFont">CREATE TABLE</span> statement. This syntax allows a column constraint to be placed on the new column within the <span class="CodeFont">ALTER TABLE ADD COLUMN</span> statement. However, a column with a <span class="CodeFont">NOT NULL</span> constraint can be added to an existing table if you give a default value; otherwise, an exception is thrown when the <span class="CodeFont">ALTER TABLE</span> statement is executed.

<span class="autonumber"><span class="noteAutoNum">NOTE:  </span></span>If a table has an <span class="CodeFont">UPDATE</span> trigger without an explicit column list, adding a column to that table in effect adds that column to the implicit update column list upon which the trigger is defined, and all references to transition variables are invalidated so that they pick up the new column.

Adding constraints

<span class="CodeFont">ALTER TABLE ADD CONSTRAINT</span> adds a table-level constraint to an existing table.

Any supported table-level constraint type can be added via <span class="CodeFont">ALTER TABLE</span>. The following limitations exist on adding a constraint to an existing table:

-   When adding a check constraint to an existing table, Splice Machine checks the table to make sure existing rows satisfy the constraint. If any row is invalid, Splice Machine throws a statement exception and the constraint is not added.
-   All columns included in a primary key must contain non null data and be unique.

    <span class="CodeFont">ALTER TABLE ADD UNIQUE</span> or <span class="CodeFont">PRIMARY KEY</span> provide a shorthand method of defining a primary key composed of a single column. If <span class="CodeFont">PRIMARY KEY</span> is specified in the definition of column C, the effect is the same as if the <span class="CodeFont">PRIMARY KEY(C)</span> clause were specified as a separate clause. The column cannot contain null values, so the <span class="CodeFont">NOT NULL</span> attribute must also be specified.

For information on the syntax of constraints, see <span class="CodeFont">[CONSTRAINT](../Clauses/Constraint.html)</span> clause. Use the syntax for table-level constraint when adding a constraint with the <span class="CodeFont">ADD TABLE ADD CONSTRAINT</span> syntax.

Dropping columns

<span class="CodeFont">ALTER TABLE DROP COLUMN</span> allows you to drop a column from a table.

The keyword <span class="CodeFont">COLUMN</span> is optional.

You may not drop the last (only) column in a table.

Modifying columns

The <span class="ItalicFont">[column-alteration](#ColumnAlteration)</span> allows you to alter the named column in the following ways:

-   Increasing the width of an existing <span class="CodeFont">VARCHAR</span> column. <span class="CodeFont">CHARACTER VARYING</span> or <span class="CodeFont">CHAR VARYING</span> can be used as synonyms for the <span class="CodeFont">VARCHAR</span> keyword.

    To increase the width of a column of these types, specify the data type and new size after the column name.

    You are not allowed to decrease the width or to change the data type. You are not allowed to increase the width of a column that is part of a primary or unique key referenced by a foreign key constraint or that is part of a foreign key constraint.

-   Specifying the interval between consecutive values of the identity column.

    To set an interval between consecutive values of the identity column, specify the integer-constant. You must previously define the column with the <span class="CodeFont">IDENTITY</span> attribute (SQLSTATE 42837). If there are existing rows in the table, the values in the column for which the <span class="CodeFont">SET INCREMENT</span> default was added do not change.

-   Modifying the nullability constraint of a column.

    You can add the <span class="CodeFont">NOT NULL</span> constraint to an existing column; however, you cannot do so if there are <span class="CodeFont">NULL</span> values for the column in the table.

    You can remove the <span class="CodeFont">NOT NULL</span> constraint from an existing column; however, you cannot do so if the column is used in a <span class="CodeFont">PRIMARY KEY</span> constraint.

-   Changing the default value for a column.

    You can use <span class="CodeFont">DEFAULT</span> default-value to change a column default. To disable a previously set default, use <span class="CodeFont">DROP DEFAULT</span> (alternatively, you can specify <span class="CodeFont">NULL</span> as the default-value).

Setting defaults

You can specify a default value for a new column. A default value is the value that is inserted into a column if no other value is specified. If not explicitly specified, the default value of a column is <span class="CodeFont">NULL</span>. If you add a default to a new column, existing rows in the table gain the default value in the new column.

For more information about defaults, see <span class="CodeFont">[CREATE TABLE](CreateTable.html)</span> statement.

An <span class="CodeFont">ALTER TABLE</span> statement causes all statements that are dependent on the table being altered to be recompiled before their next execution.

Examples

This section provides examples of using the <span class="CodeFont">ALTER TABLE</span> statement.

Example 1: Adding Columns to a Table

In this example. we create a new table, and then use <span class="CodeFont">ALTER TABLE</span> statements to add three columns that we have decided to include:

``` Example
splice> CREATE TABLE PlayerTrades (
   ID INT NOT NULL, 
   PlayerName VARCHAR(32), 
   Position CHAR(2), 
   OldTeam VARCHAR(32), 
   NewTeam VARCHAR(32) );
0 rows inserted/updated/deleted

splice> ALTER TABLE PlayerTrades ADD COLUMN Updated TIMESTAMP;
0 rows inserted/updated/deleted

splice> ALTER TABLE PlayerTrades ADD COLUMN TradeDate DATE;
0 rows inserted/updated/deleted

splice> ALTER TABLE PlayerTrades ADD COLUMN Years INT;
0 rows inserted/updated/deleted

splice> INSERT INTO PlayerTrades VALUES( 1, 'Greinke', 'SP', 'Dodgers', 'Giants', CURRENT_TIMESTAMP, CURRENT_DATE);
1 row inserted/updated/deleted

splice> DESCRIBE PlayerTrades;
COLUMN_NAME   |TYPE_NAME|DEC&|NUM&|COLUM&|COLUMN_DEF|CHAR_OCTE&|IS_NULL&
---------------------------------------------------------------------------
ID            |INTEGER  |0   |10  |10    |NULL      |NULL      |NO      
PLAYERNAME    |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
POSITION      |CHAR     |NULL|NULL|2     |NULL      |4         |YES     
OLDTEAM       |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
NEWTEAM       |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
UPDATED       |TIMESTAMP|9   |10  |29    |NULL      |NULL      |YES      
TRADEDATE     |DATE     |0   |10  |10    |NULL      |NULL      |YES     
YEARS         |INTEGER  |0   |10  |10    |NULL      |NULL      |YES     

8 rows selected
```

Example 2: Altering Columns

In this example, we use <span class="CodeFont">ALTER TABLE</span> to alter columns in various ways:

-   specify that the <span class="CodeFont">Updated</span> column cannot be <span class="CodeFont">NULL</span>
-   set the default value for <span class="CodeFont">Years</span> to <span class="CodeFont">3</span>
-   set the default value for <span class="CodeFont">NewTeam</span> to <span class="CodeFont">'Giants'</span>

``` Example
splice> ALTER TABLE PlayerTrades ALTER COLUMN Updated NOT NULL;
0 rows inserted/updated/deleted

splice> ALTER TABLE PlayerTrades ALTER COLUMN Years DEFAULT 3;
0 rows inserted/updated/deleted

splice> ALTER TABLE PlayerTrades ALTER COLUMN NewTeam DEFAULT 'Giants';
0 rows inserted/updated/deleted

splice> DESCRIBE PlayerTrades;
COLUMN_NAME   |TYPE_NAME|DEC&|NUM&|COLUM&|COLUMN_DEF|CHAR_OCTE&|IS_NULL&
---------------------------------------------------------------------------
ID            |INTEGER  |0   |10  |10    |NULL      |NULL      |NO      
PLAYERNAME    |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
POSITION      |CHAR     |NULL|NULL|2     |NULL      |4         |YES     
OLDTEAM       |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
NEWTEAM       |VARCHAR  |NULL|NULL|32    |'Giants'  |64        |YES     
UPDATED       |TIMESTAMP|9   |10  |29    |NULL      |NULL      |NO      
TRADEDATE     |DATE     |0   |10  |10    |NULL      |NULL      |YES     
YEARS         |INTEGER  |0   |10  |10    |3         |NULL      |YES

7 rows selected
```

Example 3: Dropping a column

This example drops the <span class="CodeFont">Years</span> column from our table, and then drops the default associated with <span class="CodeFont">NewTeam</span>:

``` Example
splice> ALTER TABLE PlayerTrades DROP COLUMN Years;
0 rows inserted/updated/deleted

splice> ALTER TABLE PlayerTrades ALTER COLUMN NewTeam DROP DEFAULT;
0 rows inserted/updated/deleted

splice> DESCRIBE PlayerTrades;
COLUMN_NAME   |TYPE_NAME|DEC&|NUM&|COLUM&|COLUMN_DEF|CHAR_OCTE&|IS_NULL&
---------------------------------------------------------------------------
ID            |INTEGER  |0   |10  |10    |NULL      |NULL      |NO      
PLAYERNAME    |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
POSITION      |CHAR     |NULL|NULL|2     |NULL      |4         |YES     
OLDTEAM       |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
NEWTEAM       |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
UPDATED       |TIMESTAMP|9   |10  |29    |NULL      |NULL      |NO     
TRADEDATE     |DATE     |0   |10  |10    |NULL      |NULL      |YES     

7 rows selected
```

Example 4: Changing Varchar Column Width

This example changes the width of one of our <span class="CodeFont">VARCHAR</span> columns:

``` Example
splice> ALTER TABLE PlayerTrades ALTER COLUMN PlayerName SET DATA TYPE VARCHAR(40);
0 rows inserted/updated/deleted

splice> DESCRIBE PlayerTrades;
COLUMN_NAME   |TYPE_NAME|DEC&|NUM&|COLUM&|COLUMN_DEF|CHAR_OCTE&|IS_NULL&
---------------------------------------------------------------------------
ID            |INTEGER  |0   |10  |10    |NULL      |NULL      |NO      
PLAYERNAME    |VARCHAR  |NULL|NULL|40    |NULL      |80        |YES     
POSITION      |CHAR     |NULL|NULL|2     |NULL      |4         |YES     
OLDTEAM       |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
NEWTEAM       |VARCHAR  |NULL|NULL|32    |NULL      |64        |YES     
UPDATED       |TIMESTAMP|9   |10  |29    |NULL      |NULL      |NO      
TRADEDATE     |DATE     |0   |10  |10    |NULL      |NULL      |YES     

7 rows selected
```

Example 5: Changing Increment Value

This example shows creating a table with an identity column, and then changing the increment for that column:

``` Example
splice> CREATE TABLE NewPlayers( 
   newID INT NOT NULL GENERATED ALWAYS AS IDENTITY PRIMARY KEY, 
   PlayerName);
0 rows inserted/updated/deleted

splice> ALTER TABLE NewPlayers ALTER COLUMN newID SET INCREMENT BY 10;
0 rows inserted/updated/deleted

splice> INSERT INTO NewPlayers(PlayerName) ('Greinke'),('Cespedes');
2 rows inserted/updated/deleted

splice> SELECT * FROM NewPlayers;
NEWID      |PLAYERNAME
-----------------------
1          |Greinke 
11         |Cespedes 

2 rows selected 
```

See Also

-   [<span class="CodeFont">[CONSTRAINT](../Clauses/Constraint.html)</span>](../Clauses/Constraint.html) clause
-   [<span class="CodeFont">CREATE TABLE</span>](CreateTable.html) statement
-   [Foreign Keys](../../Developers/Fundamentals/ForeignKeys.html) in the <span class="ItalicFont">Developer's Guide</span>.
-   [Triggers](../../Developers/Fundamentals/DatabaseTriggers.html) in the <span class="ItalicFont">Developer's Guide</span>.

 


