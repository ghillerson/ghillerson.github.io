<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="withMenu" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-conditions="Review.ReviewOff" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Developer's Guide|Fundamentals">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="A quick summary of window functions, as implemented in Splice Machine SQL." /><title>Splice Machine Window Functions</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/SpliceTriPaneStyles.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/SmallPatternedRows.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#Shared/Developers/Fundamentals/UsingWindowFunctions.html">Open topic with navigation</a>
        </p>
        <div class="TopicContent">
            <h1>Splice Machine Window Functions</h1>
            <p>An SQL&#160;<span class="ItalicFont">window function</span> performs a calculation across a set of table rows that are related to the current row, either by proximity in the table, or by the value of a specific column or set of columns; these columns are known as the <span class="ItalicFont">partition</span>.</p>
            <p>This topic provides a very quick summary of window functions, as implemented in Splice Machine. For more general information about SQL&#160;window functions, we recommending visiting some of the sources listed in the <a href="#ForMoreInfo" class="selected">Additional Information</a> section at the end of this topic. </p>
            <p>Here's a quick example of using a window function to operate on the following table:</p>
            <div class="indented">
                <table class="TableStyle-SmallPatternedRows" style="mc-table-style: url('../../../Resources/TableStyles/SmallPatternedRows.css');" cellspacing="0" summary="Sample table for window function examples.">
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <thead>
                        <tr class="TableStyle-SmallPatternedRows-Head-Header1">
                            <th class="TableStyle-SmallPatternedRows-HeadE-Regular-Header1">OrderID</th>
                            <th class="TableStyle-SmallPatternedRows-HeadE-Regular-Header1">CustomerID</th>
                            <th class="TableStyle-SmallPatternedRows-HeadD-Regular-Header1">Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">123</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">100</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">
                            144
                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">1                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">250</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">167</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">150</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">
                            202
                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">
                            1
                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">250</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">209</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">325</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">
                            224
                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">
                            1
                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">125</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">66</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">100</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">
                            94
                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">
                            2
                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">200</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">127</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">300</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyB-Regular-DarkerRows">
                            444
                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyB-Regular-DarkerRows">
                            2
                        </td>
                            <td class="TableStyle-SmallPatternedRows-BodyA-Regular-DarkerRows">400</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p>This query will find the first Order ID&#160;for each specified Customer ID in the above table:</p><pre class="Example" xml:space="preserve">SELECT&#160;OrderID, CustomerID,
    FIRST_VALUE(OrderID)&#160;OVER&#160;(
        PARTITION&#160;BY&#160;CustomerID
        ORDER&#160;BY&#160;OrderID
        ROWS&#160;BETWEEN&#160;UNBOUNDED&#160;PRECEDING AND&#160;CURRENT&#160;ROW&#160;)
AS&#160;FirstOrderID
FROM&#160;ORDERS
WHERE&#160;CustomerID IN&#160;(1,2);</pre>
            <p>This works by partitioning (grouping)&#160;the selected rows by CustomerID, ordering them for purposes of applying the function to the rows in the partition, and then using the <span class="CodeFont">FIRST_VALUE</span>&#160;window function to evaluate the OrderID&#160;values in each partition and find the first value in each. The results for our sample table are:</p>
            <div class="indented">
                <table class="TableStyle-SmallPatternedRows" style="mc-table-style: url('../../../Resources/TableStyles/SmallPatternedRows.css');" cellspacing="0" summary="Sample table results from a FIRST_VALUE operation.">
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <thead>
                        <tr class="TableStyle-SmallPatternedRows-Head-Header1">
                            <th class="TableStyle-SmallPatternedRows-HeadE-Regular-Header1">OrderID</th>
                            <th class="TableStyle-SmallPatternedRows-HeadE-Regular-Header1">CustomerID</th>
                            <th class="TableStyle-SmallPatternedRows-HeadD-Regular-Header1">FirstOrderID</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">123</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">123</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">144</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">123</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">167</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">123</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">202</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">123</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">209</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">123</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">224</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">123</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">66</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">66</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">94</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">66</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">127</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">66</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyB-Regular-DarkerRows">444</td>
                            <td class="TableStyle-SmallPatternedRows-BodyB-Regular-DarkerRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyA-Regular-DarkerRows">66</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p>See the <a href="#Window2" class="selected">Window Frames</a> section below for a further explanation of this query.</p>
            <h2>About Window Functions</h2>
            <p>Window functions:</p>
            <ul>
                <li value="1">Operate on a window, or set of rows. The rows considered by a window function are produced by the query's <span class="CodeFont">FROM</span> clause as filtered by its <span class="CodeFont">WHERE</span>, <span class="CodeFont">GROUP BY</span>, and <span class="CodeFont">HAVING</span> clauses, if any. This means that any row that doesn't meet the <span class="CodeFont">WHERE</span>&#160;condition is not seen by a window function.</li>
                <li value="2"> Are similar to aggregate functions, except that a window function does not group rows into a single output row. Instead, a window function returns a value for every row in the window. This is sometimes referred to as tuple-based aggregation.</li>
                <li value="3">The values are calculated from the set of rows in the window.</li>
                <li value="4">Always contain an <span class="CodeFont">OVER</span> clause, which determines how the rows of the query are divided and sequenced for processing by the window function. </li>
                <li value="5">The <span class="CodeFont">OVER</span>&#160;clause can contain a <span class="CodeFont">PARTITION</span>&#160;clause that specifies the set of rows in the table that form the window, relative to the current row.</li>
                <li value="6">
                    <p>The <span class="CodeFont">OVER</span>&#160;clause can contain an optional <span class="CodeFont">ORDER&#160;BY</span>&#160;clause that specifies in which order rows are processed by the window function. This <span class="CodeFont">ORDER&#160;BY</span>&#160;clause is independent of the <span class="CodeFont">ORDER&#160;BY</span>&#160;clause that specifies the order in which rows are output. </p>
                    <p>Note that the <a href="#The3" class="selected">ranking functions</a> (<span class="CodeFont"><a href="../../SQLReference/BuiltInFcns/DenseRank.html">DENSE_RANK</a></span>, <span class="CodeFont"><a href="../../SQLReference/BuiltInFcns/Rank.html">RANK</a></span>, and <span class="CodeFont"><a href="../../SQLReference/BuiltInFcns/RowNumber.html">ROW&#160;NUMBER</a>)</span>&#160;<span class="BoldFont">must contain</span> an <span class="CodeFont">ORDER&#160;BY</span>&#160;clause.</p>
                </li>
                <li value="7">The <span class="CodeFont">OVER</span>&#160;clause can also contain an optional <span class="ItalicFont">frame clause</span> that further restricts which of the rows in the partition are sent to the function for evaluation.</li>
            </ul>
            <h3>About Windows, Partitions, and Frames</h3>
            <p>Using window functions can seem complicated because they involve a number of overlapping terms, including <span class="ItalicFont">window</span>, <span class="ItalicFont">sliding window</span>, <span class="ItalicFont">partition</span>, <span class="ItalicFont">set</span>, and <span class="ItalicFont">window frame</span>. An additional complication is that window frames can be specified using either <span class="ItalicFont">rows</span> or <span class="ItalicFont">ranges</span>.</p>
            <p>Let's start with basic terminology definitions:</p>
            <table summary="Window functions terminology glossary.">
                <col />
                <col />
                <thead>
                    <tr>
                        <th>Terms</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="ItalicFont">window function</td>
                        <td>A function that operates on a set of rows and produces output for each row.</td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">window partition</td>
                        <td>
                            <p>The grouping of rows within a table.</p>
                            <p>Note that window partitions retains the rows, unlike aggregates, </p>
                        </td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">window ordering</td>
                        <td>The sequence of rows within each partition; this is the order in which the rows are passed to the window function for evaluation.</td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">window frame</td>
                        <td>A frame of rows within a window partition, relative to the current row. The window frame is used to further restrict the set of rows operated on by a function, and is sometimes referred to as the <span class="ItalicFont">row or range</span> clause.</td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">OVER&#160;clause</td>
                        <td>
                            <p>This is the clause used to define how the rows of the table are divided, or partitioned, for processing by the window function. It also orders the rows within the partition.</p>
                            <p>See the <a href="#The" class="selected">The OVER&#160;Clause</a> section below for more information.</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">partitioning clause</td>
                        <td>
                            <p>An optional part of an <span class="CodeFont">OVER</span>&#160;clause that divides the rows into partitions, similar to using the <span class="CodeFont">GROUP&#160;BY</span>&#160;clause. The default partition is all rows in the table, though window functions are generally calculated over a partition.</p>
                            <p>See the <a href="#Window" class="selected">The Partition Clause</a> section below for more information.</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">ordering clause</td>
                        <td>
                            <p>Defines the ordering of rows within each partition. </p>
                            <p>See the <a href="#The2" class="selected">The Order Clause</a> section below for more information.</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">frame clause</td>
                        <td>
                            <p>Further refines the set of rows when you include an <span class="CodeFont">ORDER&#160;BY</span>&#160;clause in your window function specification, by allowing you to include or exclude rows or values within the ordering. </p>
                            <p>See the <a href="#Window2" class="selected">The Frame Clause</a> section below for examples and more information.</p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <h3><a name="The"></a>The OVER&#160;Clause</h3>
            <p>A window function alway contains an <span class="CodeFont">OVER</span> clause, which determines how the rows of the query are divided, or partitioned, for processing by the window function.</p>
            <div class="preWrapper"><pre class="FcnSyntax" xml:space="preserve">expression OVER(&#160;
     [<span class="ItalicFont"><a href="#Window" class="selected">partitionClause</a></span>]
     [<span class="ItalicFont"><a href="#The2" class="selected">orderClause</a></span>]
     [<span class="ItalicFont"><a href="#Window2" class="selected">frameClause</a></span>] );
 </pre>
            </div>
            <div class="paramList">
                <p class="paramName">expression</p>
                <p class="paramDefnFirst">Any value expression that does not itself contain window function calls.</p>
            </div>
            <p class="noteNote" data-mc-autonum="NOTE: &#160;"><span class="autonumber"><span class="noteAutoNum">NOTE: &#160;</span></span>When you use an <a href="../../SQLReference/BuiltInFcns/Intro.WindowAggregrateFcns.html">aggregate function</a> such as <span class="CodeFont">AVG</span>&#160;with an <span class="CodeFont">OVER</span>&#160;clause, the aggregated value is computed per partition.</p>
            <h3><a name="Window"></a>The Partition Clause</h3>
            <p>The partition clause, which is optional, specifies how the window function is broken down over groups, in the same way that <span class="CodeFont">GROUP&#160;BY</span>&#160;specifies groupings for regular aggregate functions. Some example partitions are:</p>
            <ul>
                <li value="1">departments within an organization</li>
                <li value="2">regions within a geographic area</li>
                <li value="3">quarters within years for sales</li>
            </ul>
            <p class="noteNote" data-mc-autonum="NOTE: &#160;"><span class="autonumber"><span class="noteAutoNum">NOTE: &#160;</span></span>If you omit the partition clause, the default partition, which contains all rows in the table, is used.However, since window functions are used to perform calculations over subsets (partitions) of rows in a table, you generally should specify a partition clause.</p>
            <p class="heading4">Syntax</p>
            <div class="preWrapper"><pre class="FcnSyntax" xml:space="preserve">PARTITION&#160;BY&#160;<span class="ItalicFont">expression</span> [, ...]</pre>
            </div>
            <div class="paramListNested">
                <p class="paramName">expression [,...]</p>
                <p class="paramDefnFirst">A list of expressions that define the partitioning.</p>
            </div>
            <p>If you omit this clause, there is one partition that contains all rows in the entire table.</p>
            <p>Here's a simple example of using the partition clause to compute the average order amount per customer:</p><pre class="Example" xml:space="preserve">SELECT&#160;OrderID, CustomerID, Amount,
    Avg(Amount)&#160;OVER&#160;(
        PARTITION&#160;BY&#160;CustomerID
        ORDER&#160;BY&#160;OrderID
        ROWS&#160;BETWEEN&#160;UNBOUNDED&#160;PRECEDING AND&#160;CURRENT&#160;ROW&#160;)
AS&#160;AverageOrderAmt FROM&#160;ORDERS
WHERE&#160;CustomerID IN&#160;(1,2);</pre>
            <div class="indented">
                <table class="TableStyle-SmallPatternedRows" style="mc-table-style: url('../../../Resources/TableStyles/SmallPatternedRows.css');" cellspacing="0" summary="Results table from an AVG operation.">
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <col class="TableStyle-SmallPatternedRows-Column-Regular" />
                    <thead>
                        <tr class="TableStyle-SmallPatternedRows-Head-Header1">
                            <th class="TableStyle-SmallPatternedRows-HeadE-Regular-Header1">OrderID</th>
                            <th class="TableStyle-SmallPatternedRows-HeadE-Regular-Header1">CustomerID</th>
                            <th class="TableStyle-SmallPatternedRows-HeadE-Regular-Header1">Amount</th>
                            <th class="TableStyle-SmallPatternedRows-HeadD-Regular-Header1">AverageOrderAmt</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">123</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">100</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">200</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">144</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">250</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">200</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">167</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">150</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">200</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">202</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">250</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">200</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">209</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">325</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">200</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">224</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">1</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">125</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">200</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">66</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">100</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">250</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">94</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-DarkerRows">200</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-DarkerRows">250</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-LightRows">
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">127</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyE-Regular-LightRows">300</td>
                            <td class="TableStyle-SmallPatternedRows-BodyD-Regular-LightRows">250</td>
                        </tr>
                        <tr class="TableStyle-SmallPatternedRows-Body-DarkerRows">
                            <td class="TableStyle-SmallPatternedRows-BodyB-Regular-DarkerRows">444</td>
                            <td class="TableStyle-SmallPatternedRows-BodyB-Regular-DarkerRows">2</td>
                            <td class="TableStyle-SmallPatternedRows-BodyB-Regular-DarkerRows">400</td>
                            <td class="TableStyle-SmallPatternedRows-BodyA-Regular-DarkerRows">250</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <h3><a name="The2"></a>The Order Clause</h3>
            <p>You can also control the order in which rows are processed by window functions using <span class="CodeFont">ORDER BY</span> within your <span class="CodeFont">OVER</span> clause. This is optional, though it is important for any ranking or cumulative functions. </p>
            <p class="heading4">Syntax</p>
            <div class="preWrapper"><pre class="FcnSyntax" xml:space="preserve">ORDER&#160;BY expression 
   [ ASC&#160;|&#160;DESC&#160;|&#160;USING&#160;<span class="ItalicFont">operator</span> ]<br /> &#160;&#160;[ NULLS&#160;FIRST&#160;|&#160;NULLS&#160;LAST ]
   [, ...]</pre>
            </div>
            <p class="spaceAbove">Some notes about the <span class="CodeFont">ORDER&#160;BY</span>&#160;clause in an <span class="CodeFont">OVER</span>&#160;clause:</p>
            <ul>
                <li value="1">Ascending order (<span class="CodeFont">ASC</span>)&#160;is the default ordering.</li>
                <li value="2">If you specify <span class="CodeFont">NULLS&#160;LAST</span>, then <span class="CodeFont">NULL</span>&#160;values are returned last; this is the default when you use <span class="CodeFont">ASC</span>&#160;order. </li>
                <li value="3">If you specify <span class="CodeFont">NULLS&#160;FIRST</span>, then <span class="CodeFont">NULL</span>&#160;values are returned first; this is the default when you use <span class="CodeFont">DESC</span>&#160;order. </li>
                <li value="4">The <span class="CodeFont">ORDER BY</span> clause in your <span class="CodeFont">OVER</span>&#160;clause <span class="ItalicFont">does not</span> have to match the order in which the rows are output.</li>
                <li value="5">You can only specify a <span class="ItalicFont">frame clause</span> if you include an <span class="CodeFont">ORDER&#160;BY</span>&#160;clause in your <span class="CodeFont">OVER</span> clause.</li>
            </ul>
            <h3><a name="Window2"></a>The Frame Clause</h3>
            <p>The optional frame clause defines which of the rows in the partition (the <span class="CodeFont">frame</span>)&#160;should be evaluated by the window function. You can limit which rows in the partition are passed to the function in two ways:</p>
            <ul>
                <li value="1">Specify a <span class="CodeFont">ROWS</span> frame to limit the frame to a fixed number of rows from the partition that precede or follow the current row.</li>
                <li value="2">Specify <span class="CodeFont">RANGE</span>&#160;to only include rows in the frame whose evaluated value falls within a certain range of the current row's value. This is the default, and the current default range is <span class="CodeFont">1</span>, which means that only rows whose value matches that of the current row are passed to the function.</li>
            </ul>
            <p>Some sources refer to the frame clause as the <span class="ItalicFont">Rows or Ranges</span> clause. If you omit this clause, the default is to include all rows </p>
            <p class="noteNote" data-mc-autonum="NOTE: &#160;"><span class="autonumber"><span class="noteAutoNum">NOTE: &#160;</span></span>Window frames can only be used when you include an <span class="CodeFont">ORDER&#160;BY</span>&#160;clause within the <span class="CodeFont">OVER</span>&#160;clause.</p>
            <p class="heading4">Syntax</p>
            <p>This clause specifies two offsets: one determines the start of the window frame, and the other determines the end of the window frame.</p>
            <div class="preWrapper"><pre class="FcnSyntax" xml:space="preserve">[RANGE&#160;|&#160;ROWS] <span class="ItalicFont">frameStart</span> |
[RANGE&#160;|&#160;ROWS] BETWEEN&#160;<span class="ItalicFont">frameStart</span> AND&#160;<span class="ItalicFont">frameEnd</span></pre>
            </div>
            <div class="paramListNested">
                <p class="paramName"><span class="CodeFont">RANGE</span>
                </p>
                <p class="paramDefnFirst">The frame includes rows whose values are within a specified range of the current row's value.</p>
                <p class="paramDefn">The range is determined by the <span class="CodeFont">ORDER&#160;BY</span>&#160;column(s). Rows with identical values for their <span class="CodeFont">ORDER&#160;BY</span>&#160;columns are referred to as <span class="ItalicFont">peer rows</span>.</p>
                <p class="paramName"><span class="CodeFont">ROWS</span>
                </p>
                <p class="paramDefnFirst">The frame includes a fixed number of rows based on their position in the table relative to the current row.</p>
                <p class="paramName">frameStart</p>
                <p class="paramDefnFirst">Specifies the start of the frame.</p>
                <p class="paramDefn">For <span class="CodeFont">ROWS</span>&#160;mode, you can specify:</p>
                <blockquote>
                    <div class="preWrapper"><pre class="FcnSyntax" xml:space="preserve">UNBOUNDED&#160;PRECEDING 
| <span class="CodeItalicFont">value</span>&#160;PRECEDING
| CURRENT&#160;ROW
| <span class="CodeItalicFont">value</span>&#160;FOLLOWING</pre>
                    </div>
                    <div class="paramListNested">
                        <p class="paramName"><span class="CodeItalicFont">value</span>
                        </p>
                        <p class="paramDefnFirst">A non-negative integer value.</p>
                    </div>
                </blockquote>
                <p class="paramDefnFirst">For <span class="CodeFont">RANGE</span>&#160;mode, you can only specify:</p>
                <blockquote>
                    <div class="preWrapper"><pre class="FcnSyntax" xml:space="preserve">CURRENT&#160;ROW
|&#160;UNBOUNDED&#160;FOLLOWING</pre>
                    </div>
                </blockquote>
                <p class="paramName">frameEnd</p>
                <p class="paramDefnFirst">Specifies the end of the frame. The default value is <span class="CodeFont">CURRENT&#160;ROW</span>.</p>
                <p class="paramDefn">For <span class="CodeFont">ROWS</span>&#160;mode, you can specify:</p>
                <blockquote>
                    <div class="preWrapper"><pre class="FcnSyntax" xml:space="preserve"><span class="CodeItalicFont">value</span>&#160;PRECEDING
| CURRENT&#160;ROW
| <span class="CodeItalicFont">value</span>&#160;FOLLOWING
|&#160;UNBOUNDED&#160;FOLLOWING</pre>
                    </div>
                    <div class="paramListNested">
                        <p class="paramName"><span class="CodeItalicFont">value</span>
                        </p>
                        <p class="paramDefnFirst">A non-negative integer value.</p>
                    </div>
                </blockquote>
                <p class="paramDefnFirst">For <span class="CodeFont">RANGE</span>&#160;mode, you can only specify:</p>
                <blockquote>
                    <div class="preWrapper"><pre class="FcnSyntax" xml:space="preserve">CURRENT&#160;ROW
|&#160;UNBOUNDED&#160;FOLLOWING</pre>
                    </div>
                </blockquote>
            </div>
            <p class="heading4">Ranges and Rows</p>
            <p class="body">Probably the easiest way to understand how <span class="CodeFont">RANGE</span>&#160;and <span class="CodeFont">ROWS</span>&#160;work is by way of some simple <span class="CodeFont">OVER</span>&#160;clause examples:</p>
            <blockquote>
                <h5><a name="Example"></a>Example 1:</h5>
                <p class="body">This clause can be used to apply a window function to all rows in the partition from the top of the partition to the current row:</p><pre class="Example" xml:space="preserve">OVER&#160;(PARTITION&#160;BY&#160;customerID ORDER&#160;BY&#160;orderDate)</pre>
                <h5>Example 2:</h5>
                <p class="body">Both of these clauses specify the same set of rows as <a href="#Example" class="selected">Example 1:</a></p><pre class="Example" xml:space="preserve">OVER&#160;(PARTITION&#160;BY&#160;customerID ORDER&#160;BY&#160;orderDate UNBOUNDED&#160;PRECEDING preceding)

OVER&#160;(PARTITION&#160;BY&#160;customerID&#160;ORDER&#160;BY&#160;orderDate RANGE&#160;BETWEEN&#160;UNBOUNDED PRECEDING&#160;AND&#160;CURRENT&#160;ROW)</pre>
                <h5>Example 3:</h5>
                <p class="body">This clause can be used to apply a window function to the current row and the 3 preceding row's values in the partition:</p><pre class="Example" xml:space="preserve">OVER&#160;(PARTITION&#160;BY&#160;customerID ORDER&#160;BY&#160;orderDate ROWS&#160;3 preceding)</pre>
            </blockquote>
            <p class="heading4">FrameStart and FrameEnd</p>
            <p>Some important notes about the frame clause:</p>
            <ul>
                <li value="1"><span class="CodeFont">UNBOUNDED&#160;PRECEDING</span>&#160;means that the frame starts with the first row of the partition.</li>
                <li value="2"><span class="CodeFont">UNBOUNDED&#160;FOLLOWING</span>&#160;means that the frame ends with the last row of the partition.</li>
                <li value="3">You must specify the <span class="CodeItalicFont">frameStart</span> first and the <span class="CodeItalicFont">frameEnd</span> last within the frame clause.</li>
                <li value="4">In <span class="CodeFont">ROWS</span>&#160;mode, <span class="CodeFont">CURRENT ROW</span>&#160;means that the frame starts or ends with the current row; in <span class="CodeFont">RANGE</span>&#160;mode, <span class="CodeFont">CURRENT ROW</span>&#160;means that the frame starts or ends with the current row's first or last peer in the <span class="CodeFont">ORDER&#160;BY</span>&#160;ordering.</li>
                <li value="5">
                    <p>The default <span class="ItalicFont">frameClause</span> is to include all values from the start of the partition through the current row:&#160;</p>
                    <div class="preWrapper"><pre class="Example" xml:space="preserve">RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</pre>
                    </div>
                </li>
            </ul>
            <p class="heading4">Common Frame Clauses</p>
            <p>When learning about window functions, you may find references to these specific frame clause types:</p>
            <table summary="Some common frame clause examples">
                <col />
                <col />
                <thead>
                    <tr>
                        <th>Frame Clause Type</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="ItalicFont">Recycled</td>
                        <td class="CodeFont">BETWEEN&#160;UNBOUNDED&#160;PRECEDING&#160;AND&#160;UNBOUNDED&#160;FOLLOWING</td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">Cumulative</td>
                        <td class="CodeFont">BETWEEN&#160;UNBOUNDED&#160;PRECEDING&#160;AND&#160;CURRENT&#160;ROW</td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">Rolling</td>
                        <td class="CodeFont">BETWEEN&#160;2 PRECEDING&#160;AND&#160;2 FOLLOWING</td>
                    </tr>
                </tbody>
            </table>
            <h3>Examples</h3>
            <p>This is a simple example that doesn't use a frame clause:</p>
            <div class="opsStepsList">
                <ol class="boldFont">
                    <li value="1">
                        <p class="topLevel">Rank each year within a player by the number of home runs hit by that player:</p>
                        <div class="preWrapperWide"><pre class="Example" xml:space="preserve">
RANK()&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID&#160;ORDER&#160;BY&#160;H&#160;desc); </pre>
                        </div>
                    </li>
                </ol>
            </div>
            <p>Here are some examples of window functions using frame clauses:</p>
            <div class="opsStepsList">
                <ol class="boldFont">
                    <li value="1">
                        <p class="topLevel">Compute the running sum of G&#160;for each player:</p>
                        <div class="preWrapperWide"><pre class="Example" xml:space="preserve">
SUM(G)&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID&#160;ORDER&#160;BY&#160;yearID
  RANGE&#160;BETWEEN&#160;UNBOUNDED&#160;PRECEDING&#160;AND&#160;CURRENT&#160;ROW); </pre>
                        </div>
                    </li>
                    <li value="2">
                        <p class="topLevel">Compute the career year:</p>
                        <div class="preWrapperWide"><pre class="Example" xml:space="preserve">
YearID - min(YEARID)&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID
   RANGE&#160;BETWEEN&#160;UNBOUNDED&#160;PRECEDING&#160;AND&#160;UNBOUNDED&#160;FOLLOWING)&#160;+ 1; </pre>
                        </div>
                    </li>
                    <li value="3">
                        <p class="topLevel">Compute a rolling average of games by player:</p>
                        <div class="preWrapperWide"><pre class="Example" xml:space="preserve">
AVG(G)&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID&#160;ORDER&#160;BY&#160;yearID
   ROWS&#160;BETWEEN&#160;2 PRECEDING&#160;AND&#160;2 FOLLOWING); </pre>
                        </div>
                    </li>
                </ol>
            </div>
            <h2><a name="The3"></a>The Ranking Functions</h2>
            <p>A subset of our window functions are known as <span class="ItalicFont">ranking functions</span>:</p>
            <ul>
                <li class="CodeFont" value="1"><a href="../../SQLReference/BuiltInFcns/DenseRank.html">DENSE_RANK</a><span class="bodyFont"> ranks each row in the result set. If values in the ranking column are the same, they receive the same rank. The next number in the ranking sequence is then used to rank the row or rows that follow, which means that <span class="CodeFont">DENSE_RANK</span>&#160;always returns consecutive numbers.</span>
                </li>
                <li class="CodeFont" value="2"><a href="../../SQLReference/BuiltInFcns/Rank.html">RANK</a><span class="bodyFont"> ranks each row in the result set. If values in the ranking column are the same, they receive the same rank. However, the next number in the ranking sequence is then skipped, which means that <span class="CodeFont">RANK</span>&#160;can return non-consecutive numbers.</span>
                </li>
                <li class="CodeFont" value="3"><a href="../../SQLReference/BuiltInFcns/RowNumber.html">ROW&#160;NUMBER</a><span class="bodyFont"> assigns a sequential number to each row in the result set.</span>
                </li>
            </ul>
            <p>All ranking functions <span class="BoldFont">must include</span> an <span class="CodeFont">ORDER&#160;BY</span>&#160;clause in the <span class="CodeFont">OVER()</span>&#160;clause, since that is how they compute ranking values.</p>
            <h2>Window Function Restrictions</h2>
            <p>Because window functions are only allowed in <span class="CodeFont"><a href="../../SQLReference/Statements/Select.html">SELECT</a></span>&#160;and <span class="CodeFont"><a href="../../SQLReference/Clauses/OrderBy.html">ORDER&#160;BY</a></span>&#160;clauses, and because window functions are computed after both <span class="CodeFont">WHERE</span>&#160;and <span class="CodeFont">HAVING</span>, you sometimes need to use subqueries with window functions to accomplish what seems like it could be done in a simpler query. </p>
            <p>For example, because you cannot use an <span class="CodeFont">OVER</span>&#160;clause in a <span class="CodeFont">WHERE</span>&#160;clause, a query like the following is not possible:</p>
            <div class="preWrapper"><pre class="Example" xml:space="preserve">SELECT&#160;*
FROM&#160;Batting
WHERE&#160;rank()&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID&#160;ORDER&#160;BY&#160;G)&#160;= 1;</pre>
            </div>
            <p>And because <span class="CodeFont">WHERE</span> and <span class="CodeFont">HAVING</span>&#160;are computed before the windowing functions, this won't work either:</p>
            <div class="preWrapper"><pre class="Example" xml:space="preserve">SELECT&#160;playerID, rank()&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID&#160;ORDER&#160;BY&#160;G) as player_rank FROM&#160;Batting
WHERE&#160;player_rank&#160;= 1;</pre>
            </div>
            <p>Instead, you need to use a subquery:</p>
            <div class="preWrapper"><pre class="Example" xml:space="preserve">SELECT&#160;*
FROM&#160;(
   SELECT&#160;playerID, G, rank()&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID&#160;ORDER&#160;BY&#160;G) as "pos"
   FROM&#160;Batting
)&#160;tmp
WHERE&#160;"pos" = 1;</pre>
            </div>
            <p>And note that the above subquery will add a rank column to the original columns,</p>
            <h2><a name="IncludedFcns"></a>Window Functions Included in This Release</h2>
            <p>Splice Machine is currently expanding the set of SQL&#160;functions already able to take advantage of windowing functionality.</p>
            <p>The <span class="CodeFont"><a href="../../SQLReference/Clauses/Over.html">OVER</a></span>&#160;clause topic in our <span class="ItalicFont">SQL&#160;Reference</span> completes the complete reference information for <span class="CodeFont">OVER</span>.</p>
            <p> Here is a list of the functions that currently support windowing:</p>
            <ul>
                <li class="CodeFont" value="1"><a href="../../SQLReference/BuiltInFcns/Avg.html">AVG</a>
                </li>
                <li class="CodeFont" value="2"><a href="../../SQLReference/BuiltInFcns/Count.html">COUNT</a>
                </li>
                <li class="CodeFont" value="3"><a href="../../SQLReference/BuiltInFcns/DenseRank.html">DENSE_RANK</a>
                </li>
                <li class="CodeFont" value="4"><a href="../../SQLReference/BuiltInFcns/FirstValue.html">FIRST_VALUE</a>
                </li>
                <li class="CodeFont" value="5"><a href="../../SQLReference/BuiltInFcns/Lag.html">LAG</a>
                </li>
                <li class="CodeFont" value="6"><a href="../../SQLReference/BuiltInFcns/LastValue.html">LAST_VALUE</a>
                </li>
                <li class="CodeFont" value="7"><a href="../../SQLReference/BuiltInFcns/Lead.html">LEAD</a>
                </li>
                <li class="CodeFont" value="8"><a href="../../SQLReference/BuiltInFcns/Max.html">MAX</a>
                </li>
                <li class="CodeFont" value="9"><a href="../../SQLReference/BuiltInFcns/Min.html">MIN</a>
                </li>
                <li class="CodeFont" value="10"><a href="../../SQLReference/BuiltInFcns/Rank.html">RANK</a>
                </li>
                <li class="CodeFont" value="11"><a href="../../SQLReference/BuiltInFcns/RowNumber.html">ROW&#160;NUMBER</a>
                </li>
                <li class="CodeFont" value="12"><a href="../../SQLReference/BuiltInFcns/Sum.html">SUM</a>
                </li>
            </ul>
            <h2><a name="ForMoreInfo"></a>Additional Information</h2>
            <p>There are numerous articles about window functions that you can find online. Here are a few you might find valuable:</p>
            <ul>
                <li value="1">The <a href="https://www.simple-talk.com/sql/learn-sql-server/window-functions-in-sql-server/" target="_blank">simple talk articles from Red Gate</a> about window functions are probably the most straightforward and comprehensive descriptions of window functions.</li>
                <li value="2">This <a href="http://www.oracle.com/technetwork/issue-archive/2013/13-mar/o23sql-1906475.html" target="_blank">Oracle Technology Network article</a> provides an excellent technical introduction.</li>
                <li value="3">This <a href="http://www.postgresql.org/docs/9.1/static/tutorial-window.html" target="_blank">PostgreSQL page</a> introduces their version of window functions and links to other pages.</li>
                <li value="4">This <a href="https://wiki.postgresql.org/wiki/SQL2008_windowing_queries" target="_blank">PostgreSQL&#160;wiki page</a> about SQL&#160;windowing queries page provides a succinct explanation of why windowing functions are used, and includes several useful examples.</li>
                <li value="5">The <a href="http://en.wikipedia.org/wiki/Select_(SQL)" target="_blank">Wikipedia SQL&#160;SELECT</a>&#160;page contains descriptions of specific window functions and links to other pages.</li>
            </ul>
            <p style="font-size: 6pt;margin-top: 0;margin-bottom: 0;">&#160;</p>
        </div>
    </body>
</html>